# Django
## Template & URLs
### Django Template System
- 파이썬 데이터(context)를 HTML 문서(Template)와 결합하여, 로직과 표현을 분리한 채 동적인 웹페이지를 생성하는 도구


### HTML의 콘텐츠를 변수 값에 따라 변경하기 

빨간 상자의 내용이 **변수에 따라 바뀌는 것**을 확인해 보자.  
→ `context['name']` 값이 바뀌면, 응답 받은 **HTML의 출력 결과**도 함께 바뀐다.


### 📌 views.py

```python
def index(request):
    context = {
        'name': 'Jane',
    }
    return render(request, 'articles/index.html', context)
```

---

### 📌 articles/index.html

```html
<body>
  <h1>Hello, {{ name }}</h1>
</body>
```

---

### 📌 출력 결과

```
Hello, Jane!
```

✅ 즉, `context`에 담긴 값(`'Jane'`)이 템플릿(`{{ name }}`)에 반영되어 브라우저 화면에서 `Hello, Jane!` 이 출력됨


### Django Template system의 목적
- `페이지 틀`에 `데이터`를 동적으로 결합하여 수많은 페이지를 효율적으로 만들어 내기 위함 

---

## Ddjango Template Language
- Template에서 조건, 반복, 변수 등의 프로그래밍적 기능을 제공하는 시스템

### DTL Systax
1. Variable
2. Filters
3. Tags
4. Comments

### 1. Variable
- Django Tempalate에서의 변수
- render 함수의 세 번째 인자로 딕셔너리 타입으로 전달됨
- 해당 딕셔너리 key에 해당하는 문자열이 template에서 사용 가능한 변수명이 됨
- dot('.')을 사용하여 변수 속성에 접근할 수 있음

` {{ variable }} `
` {{ variable.attribute }} ` => 체이닝 가능

- Django Template에서의 변수
- render 함수의 세번째 인자로 딕셔너리 타입으로 전달됨
- 해당 딕셔너리 key에 해당하는 문자열이 template에서 사용 가능한 변수명이 됨
- dot('.')을 사용하여 변수 속성에 접근할 수 있음 

### 2. Filters
- 표시할 변수를 수정할 때 사용 (변수 + '|' + 필터)
- chained(연결)이 가능하며 일부 필터는 인자를 받기도 함
- 약 60개의 built-in template filters를 제공

` {{ variable|filter}} `
` {{ name|truncatewords:30 }} `

### 3. Tags
- 반복 또는 논리를 수행하여 제어 흐름을 만듦
- 일부 태그는 시작과 종료 태그가 필요
- 약 24개의 built-in template tags를 제공

` {% tag %} `
` {% if %} {% endif %} `

### 4. Comments
- 주석
  - inline
  ` {# name #} `
  
  - multiline
  ` {% comment %} `
  ` {% endcomment %}`

---

## 템플릿 상속
### 기본 템플릿 구조의 한계
- 만약 모든 템플릿에 Bootstrap을 적용하려면 ?
-> 모든 템플릿에 Bootstrap CDN을 작성해야 하나 ? 


### 템플릿 상속 (Template inheritance)
1. 페이지의 공통요소를 포함
2. 하위 템플릿이 재정의 할 수 있는 공간을 정의
=> 여러 템플릿이 공통요소를 공유할 수 있게 해주는 기능

### 상속 구조 만들기 
- skeleton 역할을 하게 되는 상위 템플릿(base.html) 작성
  - 모든 템플릿이 공유했으면 좋겠는 공통요소를 작성
  - 템플릿 별로 재정의할 부분은 block 태그를 활용
  * 파일명이 꼭 base일 필요는 없음

- 기존 하위 템플릿들이 상위 템플릿을 상속받도록 변경
  - extends 태그로 상속받을 템플릿 결정
  - block 태그를 활용해 base.html의 같은 이름으로 작성된 block 태그의 내용을 대체 


### 상속 관련 DTL 태그 
### `extends` tag
` {% extends 'articles/base.html' %}`
- 자식(하위)템플릿이 부모 템플릿을 확장한다는 것을 알림
- 반드시 자식 템플릿 최상단에 작성되어야 함
* extends 태그는 2개 이상 사용 불가함

### 'block' tag
` {% block 'content' %} {% endblock 'content' %}`
- 하위 템플릿에서 재정의할 수 있는 블록을 정의
- 상위 템플릿에서 작성하며 하위 템플릿이 작성할 수 있는 공간을 지정하는 것

---

## 요청과 응답
### HTML form
### 데이터를 보내고 가져오기(Sending and Retrieving from data)
- HTML 'form' element를 통해 사용자와 애플리케이션 간의 상호작용 이해하기

### HTML form
- HTTP 요청을 서버에 보내는 가장 편리한 방법

### 'form' element
- 사용자로부터 할당된 데이터를 서버로 전송하는 HTML 요소
=> 웹에서 사용자 정보를 입력하는 여러 방식(text, password, checkbox 등)을 제공

- ? 뒤 파라미터 name => key, 사용자 입력 => value

---

## HTML form 핵심 속성
### action & method란?
- form의 핵심 속성 2가지
- 데이터를 어디(action)로 어떤 방식(method으로 요청할지)

### action
- 입력 데이터가 전송될 URL을 지정(목적지)
* actions을 지정하지 않으면 데이터는 현재 페이지의 URL로 설정됨

### method
- 데이터를 어떤 방식으로 보낼 것인지 정의
- 데이터의 HTTP request method(GET, POST)를 지정

### `input` element
- 사용자의 데이터를 입력 받을 수 있는 HTML 요소
- type 속성 값에 따라 다양한 유형의 입력 데이터를 받음
=> 핵심 속성 `name`

### `name` attribute
- input 요소의 핵심 속성
- 사용자가 입력한 데이터에 붙이는 이름(key)
- 데이터를 제출했을 때 서버는 name 속성에 설정됨 값을 통해서만 사용자가 입력한 데이터에 접근할 수 있음

### Query String Parameters
- 사용자의 입력 데이터를 URL 주소에 파라미터를 통해 서버로 보내는 방법
- 문자를 앰퍼센드('&')로 연결된 key=value 쌍으로 구성되며, 기본 URL과는 물음표('?')로 구분됨

` http://host:port/path?key=value&key=value `

---

## HTML form 활용
### request 객체 
- form 으로 전송한 데이터 뿐만 아니라 Django로 들어오는 모든 요청 관련 데이터가 담겨 있음(view 함수가 호출될 때 첫번째 인자로 전달됨)

### request 객체에서 form 데이터 추출
- request.GET에 작성한 message가 담겨있을 확인할 수 있음
=> 딕셔너리의 get 메서드를 사용해 키의 값을 조회 

### 🔎 request.GET 안에 들어있는 것

- 클라이언트(브라우저)가 서버에 GET 요청을 보낼 때, URL 뒤에 붙여서 보낸 **쿼리 파라미터(Query String)**들이 다 들어있음

- 즉, 요청했을 때 전달된 데이터의 모음집

---

## Django URLs
### 요청과 응답에서 Django URLs의 역할
- 요청 URL에 따라 실행될 view 함수가 달라짐 

### URL dispatcher
- URL 패턴을 정의하고 해당 패턴이 일치하는 요청을 처리할 view 함수를 연결(매핑)

---

## Variable Routing
### 현재 URL 관리의 문제점
- 템플릿의 많은 부분이 중복되고, URL의 일부만 변경되는 상황이라면 ?
  - 계속해서 비슷한 URL 과 템플릿을 작성해 나가야 하나 ?

### Vraible Rounting
- URL 일부에 변수를 포함시키는 것
  - 변수는 view 함수의 인자로 전달할 수 있음

- 요청 URL의 <int:num>, <str:name>의 위치에 들어있는 값이 변수처럼 취급됨
  - 정수 num 변수가 views.detail에 문자열 name 변수가 views.greeting에 키워드 인자로 전달됨
  - 예) 요청 URL이 /articles/10/이면, views.detail(request, num = 10)의 형태로 호출
  * 키워드 인자 : 함수 호출 시 인자의 순서를 무시하고 특정 매개변수에 값을 할당하는 인자

- Path Converter
  - URL 변수의 타입을 지정
  - str, int 등 5가지 타입 지원

* Path Converter의 변수명과 View 함수의 파라미터 이름은 같아야 함 

---

## App URL 정의
### App URL mapping
- 각 앱에 URL을 정의하는 것
- 프로젝트와 각 앱이 URL을 나누어 관리를 편하게 하기 위함
- 앱이 늘어나게 되면 서로 다른 URL들이 섞이지 않도록 나누어 관리하는 방법

### 2번째 앱 pages 생성 후 발생할 수 있는 문제
- view 함수 이름이 같거나 같은 패턴의 URL 주소를 사용하게 되는 경우
=> URL을 각각 app에서 관리하자

### 기존 URL 구조
- 프로젝트 urls.py에 모든 URL이 담겨 있음

### 변경된 URL 구조
- 각 앱의 urls.py에서 각자의 URL 관리

### include 함수

` include('app.urls) `

- 프로젝트 내부 앱들의 URL을 참조할 수 있도록 매핑하는 함수
- URL의 일치하는 부분까지 잘라내고, 남은 문자열 후속 처리를 위해 include된 URL로 전달

1. 각 앱에서 urls.py를 만들고
2. 프로젝트 urls.py에서 include()로 추가

---

## URL 이름 지정
### Naming URL partterns
### URL 구조 변경에 따른 문제점
- 기존 'articles/' 주소가 'articles/index/'로 변경됨에 따라 해당 URL을 사용하는 모든 위치를 찾아가 변경해야 함

=> URL에 이름을 지정하는 것
=> path 함수에 name 인자를 키워드 인자로 정의해서 사용

* a 태그의 href 속성 값 뿐만 아니라 form 의 action 속성 등도 변경해 주어어 함

---

## DTL URL tag

` 'url' tag `
` {% url 'url_name' arg1 arg2 %} `

- 주어진 URL 패턴의 이름과 일치하는 절대 경로 주소를 반환
- URL에 이름을 붙였을 경우 url태그와 이름을 이용해 템플릿 상에서 이름으로 실제 주소를 작성할 수 있게 해줌

* 태그 이름, URL 이름, 인자 등은 콤마(,)로 구분되지 않음

- URL 패턴에 변수가 포함되어 있으면 'url_name' 이후 추가

` { % url 'detail' 1 % } `

- DTL의 for 태그에서 사용한 변수 이름 사용 가능 

---

## URL 이름 공간
### app_name 속성
### URL 이름 지정 후 남은 문제
- articles 앱의 url 이름과 pages 앱의 url 이름이 같은 상황
- 단순히 이름으로는 완벽하게 분리할 수 없음

=> 이름에 성(key)을 붙이자

1. urls.py에 app_name 변수 설정
2. app_name이 추가 또는 수정되면 url 태그에도 해당 내용이 반영되어야 함
