# Django
## ORM(Object-Relational-Mapping)
- ê°ì²´ ì§€í–¥ í”„ë¡œê·¸ë˜ë° ì–¸ì–´ì˜ ê°ì²´ì™€ ë°ì´í„°ë² ì´ìŠ¤ì˜ ë°ì´í„°ë¥¼ ë§¤í•‘í•˜ëŠ” ê¸°ìˆ 
- ê°œë°œì ì¹œí™”ì ì¸ ë°ì´í„°ë² ì´ìŠ¤ ì¸í„°í˜ì´ìŠ¤ 

### ë¬¸ì œ ìƒí™© : ì–¸ì–´ ì°¨ì´ë¡œ ì¸í•œ ì†Œí†µ ë¶ˆê°€
- DjangoëŠ” Python ì–¸ì–´ë¥¼ ì‚¬ìš©í•˜ì§€ë§Œ ë°ì´í„°ë°°ì´ìŠ¤ëŠ” SQL ì–¸ì–´ë¥¼ ì‚¬ìš©í•¨

### ORMì˜ ì—­í•  : ë²ˆì—­ì ì—­í• 
- ORMì€ Djangoì™€ ë°ì´í„°ë² ì´ìŠ¤ ì‚¬ì´ì—ì„œ ì–¸ì–´ ë²ˆì—­ì ì—­í• ì„ ìˆ˜í–‰

### Djangoì˜ ë°ì´í„° ìƒí˜¸ì‘ìš© : ORMì´ ì¼í•˜ëŠ” ë°©ë²•
- ORMì€ Django ê°œë°œìë¥¼ ìœ„í•´ 'QuerySet API'ë¼ëŠ” íŠ¹ë³„í•œ ë„êµ¬ë¥¼ ì œê³µí•¨
  - QuerySet APIëŠ” ORMì˜ ê¸°ëŠ¥ì„ ê°œë°œìê°€ Python ì½”ë“œ ì•ˆì—ì„œ ê°ì²´ ì§€í–¥ì ì´ê³  ì§ê´€ì ì¸ ë°©ì‹ìœ¼ë¡œ ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ì¡°ì‘í•  ìˆ˜ ìˆë„ë¡ ì œê³µí•˜ëŠ” ì¸í„°í˜ì´ìŠ¤

---

## QuerySet API
- ë°ì´í„°ë² ì´ìŠ¤ì˜ ë³µì¡í•œ SQL ì¿¼ë¦¬ë¬¸ì„ ì§ê´€ì ì¸ Python ì½”ë“œë¡œ ë‹¤ë£° ìˆ˜ ìˆê²Œ í•´ì£¼ëŠ” ê°•ë ¥í•œ ë²ˆì—­ê¸° 
- ê°œë°œìëŠ” SQLì„ ì§ì ‘ ì‘ì„±í•˜ì§€ ì•Šê³ ë„ .filter(), exclude(), .order_by() ë“± íŒŒì´ì¬ë‹¤ìš´ ë©”ìŠ¤ë“œë¥¼ ì‚¬ìš©í•˜ì—¬ ì›í•˜ëŠ” ë°ì´í„°ë¥¼ ì†ì‰½ê²Œ ìƒì„±, ì¡°íšŒ, ìˆ˜ì •, ì‚­ì œí•  ìˆ˜ ìˆìŒ
- ì½”ë“œì˜ ê°€ë…ì„±ì„ ë†’ì´ê³  ê°œë°œ ìƒì‚°ì„±ì„ ê·¹ëŒ€í™”í•˜ëŠ” Django ORMì˜ í•µì‹¬ ê¸°ëŠ¥

### QuerySet APIì™€ ORMì˜ ë™ì‘ ë°©ì‹
1. Django -> DB : Django(QuerySet API)ì—ì„œ ORMì„ í†µí•´ ë°ì´í„°ë² ì´ìŠ¤ë¡œ ì •ë³´ë¥¼ ìš”ì²­í•  ë–„ 
  - SQL ì¿¼ë¦¬ë¡œ ë³€í™˜ë˜ì–´ ë°ì´í„°ë² ì´ìŠ¤ë¡œ ì „ë‹¬ë¨

2. DB -> Django : ë°ì´í„°ë² ì´ìŠ¤ê°€ ìš”ì²­ì— ëŒ€í•œ ì‘ë‹µì„ ë³´ë‚¼ ë•Œ
  - ORMì€ ì´ SQL ê²°ê³¼ë¥¼ ë‹¤ì‹œ íŒŒì´ì¬ì´ ì´í•´í•  ìˆ˜ ìˆëŠ” Python Object
  - QuerySet ë˜ëŠ” Instance í˜•íƒœë¡œ ë³€í™˜í•˜ì—¬ Djangoë¡œ ë°˜í™˜


### QuerySet API êµ¬ë¬¸ ê¸°ë³¸ êµ¬ì¡°

`Article.objects.all()`

### 1. Article (ëª¨ë¸ í´ë˜ìŠ¤)

* ì—­í• : ë°ì´í„°ë² ì´ìŠ¤ í…Œì´ë¸”ì— ëŒ€í•œ **Python í´ë˜ìŠ¤ í‘œí˜„**
* ì˜ˆì‹œ: `articles_article` í…Œì´ë¸”ì˜ ìŠ¤í‚¤ë§ˆ(í•„ë“œ, ë°ì´í„° íƒ€ì… ë“±)ë¥¼ ì •ì˜
* Django ORMì´ ë°ì´í„°ë² ì´ìŠ¤ì™€ ìƒí˜¸ì‘ìš©í•  ë•Œ ì‚¬ìš©í•˜ëŠ” ê¸°ë³¸ êµ¬ì¡°ì²´

### 2. .objects (ë§¤ë‹ˆì €, Manager)

* ì—­í• : ë°ì´í„°ë² ì´ìŠ¤ ì¡°íšŒ(Query) ì‘ì—…ì„ ìœ„í•œ ê¸°ë³¸ ì¸í„°í˜ì´ìŠ¤
* ëª¨ë¸ í´ë˜ìŠ¤ê°€ ë°ì´í„°ë² ì´ìŠ¤ ì¿¼ë¦¬ ì‘ì—…ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆë„ë¡ í•˜ëŠ” ì§„ì…ì 
* DjangoëŠ” ëª¨ë“  ëª¨ë¸ì— `objects`ë¼ëŠ” ì´ë¦„ì˜ ë§¤ë‹ˆì €ë¥¼ ìë™ìœ¼ë¡œ ì¶”ê°€
* ì´ ë§¤ë‹ˆì €ë¥¼ í†µí•´ `.all()`, `.filter()` ë“± ì¿¼ë¦¬ ë©”ì„œë“œë¥¼ í˜¸ì¶œí•  ìˆ˜ ìˆìŒ

### 3. .all() (QuerySet API ë©”ì„œë“œ)

* ì—­í• : íŠ¹ì • ë°ì´í„°ë² ì´ìŠ¤ ì‘ì—…ì„ ìˆ˜í–‰í•˜ëŠ” ëª…ë ¹
* ë§¤ë‹ˆì €ë¥¼ í†µí•´ í˜¸ì¶œë˜ëŠ” ë©”ì„œë“œë¡œ, í•´ë‹¹ ëª¨ë¸ê³¼ ì—°ê²°ëœ í…Œì´ë¸”ì˜ **ëª¨ë“  ë ˆì½”ë“œ(rows)** ë¥¼ ì¡°íšŒí•˜ëŠ” SQL ì¿¼ë¦¬ë¥¼ ìƒì„±í•˜ê³  ì‹¤í–‰


ì¦‰, `Article.objects.all()` ì€

* **Article**: ëª¨ë¸ í´ë˜ìŠ¤
* **objects**: ë§¤ë‹ˆì € (ì¿¼ë¦¬ ì‹¤í–‰ ì§„ì…ì )
* **all()**: ëª¨ë“  ë ˆì½”ë“œ ì¡°íšŒí•˜ëŠ” ì¿¼ë¦¬ ì‹¤í–‰


---


### Django ORM â†” SQL ëŒ€ì¡°í‘œ

| êµ¬ë¶„                | Django ORM ì½”ë“œ                                                                                   | ì‹¤í–‰ë˜ëŠ” SQL                                                                  | ì„¤ëª…                                |
| ----------------- | ----------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------- | --------------------------------- |
| **Create**        | `Article.objects.create(title="hello", content="world")`                                        | `INSERT INTO appname_article (title, content) VALUES ('hello', 'world');` | ìƒˆ ë ˆì½”ë“œ ì¶”ê°€                          |
| **Read (ì „ì²´)**     | `Article.objects.all()`                                                                         | `SELECT * FROM appname_article;`                                          | ëª¨ë“  ë ˆì½”ë“œ ì¡°íšŒ                         |
| **Read (ì¡°ê±´)**     | `Article.objects.filter(title="hello")`                                                         | `SELECT * FROM appname_article WHERE title = 'hello';`                    | ì¡°ê±´ì— ë§ëŠ” ë ˆì½”ë“œ ì—¬ëŸ¬ ê°œ ì¡°íšŒ                |
| **Read (ë‹¨ì¼)**     | `Article.objects.get(id=1)`                                                                     | `SELECT * FROM appname_article WHERE id = 1 LIMIT 1;`                     | ì¡°ê±´ì— ë§ëŠ” ë ˆì½”ë“œ ë‹¨ì¼ ì¡°íšŒ (ì—†ê±°ë‚˜ 2ê°œ ì´ìƒì´ë©´ ì˜¤ë¥˜) |
| **ì •ë ¬**            | `Article.objects.order_by("title")`                                                             | `SELECT * FROM appname_article ORDER BY title ASC;`                       | ì˜¤ë¦„ì°¨ìˆœ ì •ë ¬                           |
|                   | `Article.objects.order_by("-title")`                                                            | `SELECT * FROM appname_article ORDER BY title DESC;`                      | ë‚´ë¦¼ì°¨ìˆœ ì •ë ¬                           |
| **Update (ì¸ìŠ¤í„´ìŠ¤)** | `python<br>article = Article.objects.get(id=1)<br>article.title = "updated!"<br>article.save()` | `UPDATE appname_article SET title='updated!' WHERE id=1;`                 | íŠ¹ì • ë ˆì½”ë“œ ìˆ˜ì •                         |
| **Update (ë°”ë¡œ)**   | `Article.objects.filter(id=1).update(title="updated!")`                                         | `UPDATE appname_article SET title='updated!' WHERE id=1;`                 | ì¡°ê±´ì— ë§ëŠ” ë ˆì½”ë“œ ì¼ê´„ ìˆ˜ì •                  |
| **Delete**        | `python<br>article = Article.objects.get(id=1)<br>article.delete()`                             | `DELETE FROM appname_article WHERE id=1;`                                 | íŠ¹ì • ë ˆì½”ë“œ ì‚­ì œ                         |
| **Count**         | `Article.objects.count()`                                                                       | `SELECT COUNT(*) FROM appname_article;`                                   | ì „ì²´ ë ˆì½”ë“œ ê°œìˆ˜                         |
| **First**         | `Article.objects.first()`                                                                       | `SELECT * FROM appname_article ORDER BY id ASC LIMIT 1;`                  | ì²« ë²ˆì§¸ ë ˆì½”ë“œ                          |
| **Last**          | `Article.objects.last()`                                                                        | `SELECT * FROM appname_article ORDER BY id DESC LIMIT 1;`                 | ë§ˆì§€ë§‰ ë ˆì½”ë“œ                           |
| **Values**        | `Article.objects.values("title")`                                                               | `SELECT title FROM appname_article;`                                      | íŠ¹ì • ì»¬ëŸ¼ë§Œ ì¡°íšŒ                         |
| **Distinct**      | `Article.objects.distinct()`                                                                    | `SELECT DISTINCT ... FROM appname_article;`                               | ì¤‘ë³µ ì œê±°                             |

---

### Queryë€ ? 
- ë°ì´í„°ë² ì´ìŠ¤ì— íŠ¹ì •í•œ ë°ì´í„°ë¥¼ ë³´ì—¬ ë‹¬ë¼ëŠ” ìš”ì²­
- "ì¿¼ë¦¬ë¬¸ì„ ì‘ì„±í•œë‹¤"
  - ì›í•˜ëŠ” ë°ì´í„°ë¥¼ ì–»ê¸° ìœ„í•´ ë°ì´í„°ë² ì´ìŠ¤ì— ìš”ì²­ì„ ë³´ë‚¼ ì½”ë“œë¥¼ ì‘ì„±í•œë‹¤
- Djangoì—ì„œ Queryê°€ ì²˜ë¦¬ë˜ëŠ” ê³¼ì • ì •ë¦¬
  1. íŒŒì´ì¬ ì½”ë“œ -> ORM : ê°œë°œìì˜ QuerySet API(íŒŒì´ì¬ ì½”ë“œ)ê°€ ORMìœ¼ë¡œ ì „ë‹¬
  2. ORM -> SQL ë³€í™˜ : ORMì´ ì´ë¥¼ ë°ì´í„°ë² ì´ìŠ¤ìš© SQL ì¿¼ë¦¬ë¡œ ë³€í™˜í•˜ì—¬ ë°ì´í„°ë² ì´ìŠ¤ì— ì „ë‹¬
  3. DB ì‘ë‹µ -> ORM : ë°ì´í„°ë² ì´ìŠ¤ê°€ SQL ì¿¼ë¦¬ë¥¼ ì²˜ë¦¬í•˜ê³  ê²°ê³¼ ë°ì´í„°ë¥¼ ORMì— ë°˜í™˜
  4. ORM -> QuerySet ë³€í™˜ : ORMì´ ë°ì´í„°ë² ì´ìŠ¤ì˜ ê²°ê³¼ë¥¼ QuerySet(íŒŒì´ì¬ ê°ì²´) í˜•íƒœë¡œ ë³€í™˜í•˜ì—¬ ìš°ë¦¬ì—ê²Œ ì „ë‹¬

### QuerySetì´ë€ ? 
- ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ ì „ë‹¬ë°›ì€ ê°ì²´ ëª©ë¡(ë°ì´í„° ëª¨ìŒ)
- ìˆœíšŒ ê°€ëŠ¥í•œ ë°ì´í„°ë¡œ 1ê°œ ì´ìƒ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì™€ ì‚¬ìš© ê°€ëŠ¥í•¨
- Django ORMì„ í†µí•´ ë§Œë“¤ì–´ì§„ ìë£Œí˜•
- ë‹¨, ë°ì´í„°ë² ì´ìŠ¤ê°€ ë‹¨ì¼ ê°ì²´ë¥¼ ë°˜í™˜í•  ë•ŒëŠ” QuerySetì´ ì•„ë‹Œ ëª¨ë¸(Class)ì˜ ì¸ìŠ¤í„´ìŠ¤ë¡œ ë°˜í™˜ë¨

---

## QuerySet API ì‹¤ìŠµ
### CRUDë€ ? 
- ëŒ€ë¶€ë¶„ì˜ ì†Œí”„íŠ¸ì›¨ì–´ê°€ ê°€ì§€ëŠ” ê¸°ë³¸ì ì¸ ë°ì´í„° ì²˜ë¦¬ ê¸°ëŠ¥ì¸ ìƒì„±, ì¡°íšŒ, ìˆ˜ì •, ì‚­ì œë¥¼ ë¬¶ì–´ ì´ë¥´ëŠ” ë§
- Djangoì—ì„œëŠ” QuerySet APIë¥¼ í†µí•´, ë³µì¡í•œ SQLë¬¸ ì—†ì´ Python ì½”ë“œë¡œ ì´ëŸ¬í•œ CRUD ì‘ì—…ì„ ì§ê´€ì ìœ¼ë¡œ ìˆ˜í–‰í•  ìˆ˜ ìˆìŒ

--- 

### Create

### QuerySet API ì‹¤ìŠµ ì‚¬ì „ ì¤€ë¹„ & ë°ì´í„° ìƒì„± ë°©ë²•

### 1. ì™¸ë¶€ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì„¤ì¹˜ ë° ì˜ì¡´ì„± ê¸°ë¡

* **IPython**: ì¼ë°˜ íŒŒì´ì¬ ì…€ë³´ë‹¤ ìë™ ì™„ì„± ë“± í¸ë¦¬í•œ ì‘ì—… í™˜ê²½ ì œê³µ
* ì„¤ì¹˜ ë° ì˜ì¡´ì„± ê¸°ë¡

  ```bash
  $ pip install ipython
  $ pip freeze > requirements.txt
  ```


### 2. Django Shell ì ‘ì†í•˜ê¸°

* **Django Shellì´ë€?**

  * Django í”„ë¡œì íŠ¸ ì½”ë“œë¥¼ ëª…ë ¹ì°½ì—ì„œ ì‹¤í–‰í•˜ê³  í…ŒìŠ¤íŠ¸í•  ìˆ˜ ìˆëŠ” íŠ¹ë³„í•œ íŒŒì´ì¬ í™˜ê²½
  * Django í™˜ê²½ ë‚´ì—ì„œ ì‹¤í–‰ë˜ë¯€ë¡œ QuerySet API êµ¬ë¬¸ì´ ì‹¤ì œ í”„ë¡œì íŠ¸ì— ì˜í–¥ì„ ë¯¸ì¹¨
* ì ‘ì† ëª…ë ¹ì–´

  ```bash
  $ python manage.py shell
  ```


### 3. Django Shell ì˜µì…˜

* `-v` ì˜µì…˜ (ê¸°ë³¸ê°’ 1): ì¶œë ¥ ìƒì„¸ë„ ì„¤ì • (ë” ë§ì€ ë””ë²„ê¹…/ì§„í–‰ ë©”ì‹œì§€ í™•ì¸ ê°€ëŠ¥)
* ì˜ˆì‹œ

  ```bash
  $ python manage.py shell -v 2
  ```

  â†’ í”„ë¡œì íŠ¸ì— ë“±ë¡ëœ model ë“¤ì´ ìë™ìœ¼ë¡œ import ë¨


### 4. ë°ì´í„° ê°ì²´ë¥¼ ë§Œë“œëŠ” 3ê°€ì§€ ë°©ë²•

1. ë¹ˆ ê°ì²´ ìƒì„± í›„ ê°’ í• ë‹¹ ë° ì €ì¥
2. ì´ˆê¸° ê°’ê³¼ í•¨ê»˜ ê°ì²´ ìƒì„± ë° ì €ì¥
3. `create()` ë©”ì„œë“œë¡œ í•œ ë²ˆì— ìƒì„± ë° ì €ì¥


### 5. ì²« ë²ˆì§¸ ë°©ë²•: ë¹ˆ ê°ì²´ ìƒì„± í›„ ê°’ í• ë‹¹ ë° ì €ì¥

```python
# ê°ì²´ ìƒì„± (ì•„ì§ ì €ì¥ ì•ˆ ë¨)
article = Article()
article.title = 'first'
article.content = 'django!'

# save() í˜¸ì¶œ ì „ì—ëŠ” DBì— ì €ì¥ë˜ì§€ ì•ŠìŒ
article.save()   # ì €ì¥ë¨
```

* `article.id` ë˜ëŠ” `article.pk` ë¡œ ê¸°ë³¸í‚¤ í™•ì¸ ê°€ëŠ¥
* `Article.objects.all()` â†’ ì €ì¥ëœ ê°ì²´ ì¡°íšŒ ê°€ëŠ¥


### 6. ë‘ ë²ˆì§¸ ë°©ë²•: ì´ˆê¸° ê°’ê³¼ í•¨ê»˜ ìƒì„± í›„ ì €ì¥

```python
article = Article(title='second', content='django!')
article.save()
```

* ì—­ì‹œ `save()`ë¥¼ í˜¸ì¶œí•´ì•¼ ì‹¤ì œ DBì— ë°˜ì˜ë¨


### 7. save() ë©”ì„œë“œë€?

* ê°ì²´ë¥¼ DBì— ì €ì¥í•˜ëŠ” ì¸ìŠ¤í„´ìŠ¤ ë©”ì„œë“œ
* **ì–¸ì œ í•„ìš”í•œê°€?**

  * ê°ì²´ë¥¼ ìƒì„± í›„ DBì— ì €ì¥í•˜ê¸° ì „ì— **ì¶”ê°€ì ì¸ ì²˜ë¦¬**ê°€ í•„ìš”í•  ë•Œ
  * ì˜ˆ: ë‹¤ë¥¸ ë°ì´í„°ì™€ì˜ ê´€ê³„ ì„¤ì •, ìœ íš¨ì„± ê²€ì‚¬ ë“±


### 8. ì„¸ ë²ˆì§¸ ë°©ë²•: create() ë©”ì„œë“œë¡œ í•œ ë²ˆì— ìƒì„± ë° ì €ì¥

```python
Article.objects.create(title='third', content='django!')
```

* ê°ì²´ ìƒì„± + DB ì €ì¥ì„ ë™ì‹œì— ì²˜ë¦¬í•˜ëŠ” ë‹¨ì¶• ë©”ì„œë“œ
* `save()`ë¥¼ ë”°ë¡œ í˜¸ì¶œí•  í•„ìš” ì—†ìŒ


ğŸ‘‰ ìš”ì•½

* **ë¹ˆ ê°ì²´ í›„ save()**
* **ì´ˆê¸° ê°’ ë„£ê³  save()**
* **create() í•œ ë²ˆì— ì €ì¥**


---


## Read
### ëŒ€í‘œì ì¸ ì¡°íšŒ ë©”ì„œë“œ
- QuerySet ë°˜í™˜ ë©”ì„œë“œ
  - all()
  - filter()

- QuerySetì„ ë°˜í™˜í•˜ì§€ ì•ŠëŠ” ë©”ì„œë“œ
  - get()

### QuerySet ë°˜í™˜ ë©”ì„œë“œ : all()
- ì „ì²´ ë°ì´í„° ì¡°íšŒ 
- ` Article.objects.all() `

### QuerySet ë°˜í™˜ ë©”ì„œë“œ : filter()
- ì£¼ì–´ì§„ ë§¤ê°œë³€ìˆ˜ì™€ ì¼ì¹˜í•˜ëŠ” ê°ì²´ë¥¼ í¬í•¨í•˜ëŠ” QuerySet ë°˜í™˜
- ` Article.objtects.filter(content='django!') `

### QuerySetì„ ë°˜í™˜í•˜ì§€ ì•ŠëŠ” ë©”ì„œë“œ : get()
- ì£¼ì–´ì§„ ë§¤ê°œë³€ìˆ˜ì™€ ì¼ì¹˜í•˜ëŠ” **ê°ì²´ë¥¼ ë°˜í™˜(í•˜ë‚˜)**
- ` Article.objects.get(pk=1) `

* ë§Œì•½ ì¡°ê±´ì— ë¶€í•©í•˜ëŠ” ê°ì²´ê°€ ì—†ë‹¤ë©´ ? 
=> ì˜ˆì™¸ë°œìƒ 
=> DoesNotExit : Article matching query does not exist.

* ë§Œì•½ ì¡°ê±´ì— ë¶€í•©í•˜ëŠ” ê°ì²´ê°€ ì—¬ëŸ¬ ê°œë©´ ? 
=> ì˜ˆì™¸ë°œìƒ 
=> MultipleObjectsReturned : get() returned more than one Article -- it returned 2!

=> ë”°ë¼ì„œ getì€ **primary key**ì— ì“°ëŠ” ê²Œ ì¢‹ìŒ
=> pkëŠ” unique, not nullì´ê¸° ë•Œë¬¸ì— (ê³ ìœ ì„± ë³´ì¥)

--- 

## Update
### ë°ì´í„° ìˆ˜ì • ë°©ë²•
- ì¸ìŠ¤í„´ìŠ¤ ë³€ìˆ˜ë¥¼ ë³€ê²½ í›„ save ë©”ì„œë“œ í˜¸ì¶œ

```bash
# ìˆ˜ì •í•  ì¸ìŠ¤í„´ìŠ¤ ì¡°íšŒ
>>> article = Article.objects.get(pk=1)

# ì¸ìŠ¤í„´ìŠ¤ ë³€ìˆ˜ë¥¼ ë³€ê²½
>>> article.title = 'byebye'

# ì €ì¥
>>> article.save()
```

---

## Delete
### ë°ì´í„° ì‚­ì œ ë°©ë²•
- ì‚­ì œí•˜ë ¤ëŠ” ë°ì´í„° ì¡°íšŒ í›„ delete ë©”ì„œë“œ í˜¸ì¶œ

```bash
# ì‚­ì œí•  ì¸ìŠ¤í„´ìŠ¤ ì¡°íšŒ
>>> article = Article.objects.get(pk=1)

# delete ë©”ì„œë“œ í˜¸ì¶œ(ì‚­ì œëœ ê°ì²´ê°€ ë°˜í™˜)
>>> article.delete()
(1, {'articles.Article': 1})

# ì‚­ì œí•œ ë°ì´í„°ëŠ” ë”ì´ìƒ ì¡°íšŒí•  ìˆ˜ ì—†ìŒ
>>> Article.obtjecs.get(pk=1)
DoesNotExist: Article matching query does not exist
```

---

## ORM with view
### ì „ì²´ ê²Œì‹œê¸€ ì¡°íšŒ
### ORM with view
- View í•¨ìˆ˜ì—ì„œ QuerySet API í™œìš©í•˜ê¸°
  - viewì—ì„œì˜ QuerySet API:
    - ì›¹ í˜ì´ì§€ì— ë³´ì—¬ì¤„ ë°ì´í„°ë¥¼ DBì—ì„œ ê°€ì ¸ì˜¬ ë•Œ ì‚¬ìš©í•¨
    - ì‚¬ìš©ìê°€ ì…ë ¥í•œ ìƒˆë¡œìš´ ë°ì´í„°ë¥¼ DBì— ì €ì¥í•  ë•Œ ì‚¬ìš©í•¨

- 2ê°€ì§€ Read(ì¡°íšŒ)
  1. ì „ì²´ ê²Œì‹œê¸€ ì¡°íšŒ
  2. ë‹¨ì¼ ê²Œì‹œê¸€ ì¡°íšŒ



### ì „ì²´ ê²Œì‹œê¸€ ì¡°íšŒ

### 1. ìš”ì²­ ì •ì˜

`crud/urls.py`

```python
from django.urls import path, include

urlpatterns = [
    path('admin/', admin.site.urls),
    path('articles/', include('articles.urls')),
]
```

`articles/urls.py`

```python
from django.urls import path
from . import views

urlpatterns = [
    path('', views.index, name='index'),
]
```

### TIP

* `include("articles.urls")` â†’ `articles/` ë¡œ ì‹œì‘í•˜ëŠ” ëª¨ë“  ìš”ì²­ì„ `articles/urls.py` ë¡œ ë„˜ê¹€
* `articles/` ë’¤ì— ì•„ë¬´ê²ƒë„ ì—†ëŠ” ê²½ìš°(`path('', views.index)`)ëŠ” **`articles/` ìì²´**ë¥¼ ì˜ë¯¸ â†’ `index` ë·° ì‹¤í–‰


### 2. View & Template

`articles/views.py`

```python
from .models import Article

def index(request):
    articles = Article.objects.all()
    context = {
        'articles': articles,
    }
    return render(request, 'articles/index.html', context)
```

`articles/index.html`

```html
<h1>Articles</h1>
<hr>
{% for article in articles %}
  <p>ê¸€ ë²ˆí˜¸: {{ article.pk }}</p>
  <p>ê¸€ ì œëª©: {{ article.title }}</p>
  <p>ê¸€ ë‚´ìš©: {{ article.content }}</p>
  <hr>
{% endfor %}
```

* `urls.py`ì—ì„œ ìš”ì²­ ê²½ë¡œ ì„¤ì • â†’ `views.py`ì—ì„œ DB ì¡°íšŒ (`Article.objects.all()`) â†’ `index.html`ì—ì„œ `for`ë¬¸ìœ¼ë¡œ ì¶œë ¥
* ì´ë ‡ê²Œ í•´ì„œ **ì „ì²´ ê²Œì‹œê¸€ ì¡°íšŒ** ê¸°ëŠ¥ êµ¬í˜„ ì™„ë£Œ


---


## Field lookups: ë°ì´í„° í•„í„°ë§ì˜ ë§ˆë²•
### 1. Field lookups ê°œë…

* ë‹¨ìˆœ ë™ì¹˜ ë¹„êµ(`=`)ë¥¼ ë„˜ì–´ì„œ ë” ìƒì„¸í•œ ì¡°ê±´ìœ¼ë¡œ ë°ì´í„°ë¥¼ ì¡°íšŒí•  ìˆ˜ ìˆë„ë¡ Django ORMì´ ì œê³µí•˜ëŠ” ê¸°ëŠ¥
* ì˜ˆì‹œ:

  * `'íŠ¹ì • ë‹¨ì–´ê°€ í¬í•¨ëœ ì œëª©'`
  * `'íŠ¹ì • ë‚ ì§œ ì´í›„ì— ì‘ì„±ëœ ê¸€'`
* ë³µì¡í•œ ë°ì´í„° ì¡°íšŒë¥¼ íŒŒì´ì¬ ì½”ë“œë¡œ ê°„ê²°í•˜ê³  ê°•ë ¥í•˜ê²Œ ì²˜ë¦¬ ê°€ëŠ¥


### Field lookupsì˜ ê°„ë‹¨í•œ ì˜ˆì‹œ

```python
Article.objects.filter(title__startswith='second')
```

* `title` í•„ë“œê°€ `'second'`ë¡œ ì‹œì‘í•˜ëŠ” Article ë°ì´í„°ë¥¼ ì¡°íšŒ
* **êµ¬ì¡°**

  * ëª¨ë¸ í•„ë“œëª… + `__`(double underscore, ì´ì¤‘ ë°‘ì¤„) + ì¡°íšŒ ì¡°ê±´ = ë¹„êµí•  ê°’
* ì‚¬ìš© ê°€ëŠ¥ ë©”ì„œë“œ: `filter()`, `exclude()`, `get()`

### ì¶”ê°€ ì˜ˆì‹œ

```python
# ë‚´ìš©ì— 'dja'ê°€ í¬í•¨ëœ ëª¨ë“  ê²Œì‹œê¸€ ì¡°íšŒ
Article.objects.filter(content__contains='dja')

# ì œëª©ì´ 'he'ë¡œ ì‹œì‘í•˜ëŠ” ëª¨ë“  ê²Œì‹œê¸€ ì¡°íšŒ
Article.objects.filter(title__startswith='he')
```

### 3. ë‹¤ì–‘í•œ ì¡°íšŒ ì¡°ê±´ (Field lookups ì¡°ê±´)

* **exact / iexact**

  * `exact`: ëŒ€ì†Œë¬¸ìë¥¼ êµ¬ë¶„í•˜ì—¬ ì •í™•íˆ ì¼ì¹˜í•˜ëŠ” ê°’ ì¡°íšŒ
  * `iexact`: ëŒ€ì†Œë¬¸ì êµ¬ë¶„ ì—†ì´ ì •í™•íˆ ì¼ì¹˜í•˜ëŠ” ê°’ ì¡°íšŒ

* **contains / icontains**

  * `contains`: íŠ¹ì • ê°’ì´ ë¬¸ìì—´ì— í¬í•¨ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸ (ëŒ€ì†Œë¬¸ì êµ¬ë¶„)
  * `icontains`: íŠ¹ì • ê°’ì´ í¬í•¨ë˜ì—ˆëŠ”ì§€ í™•ì¸ (ëŒ€ì†Œë¬¸ì êµ¬ë¶„ ì—†ìŒ)

* **ë¹„êµ ì—°ì‚°ì (gt, gte, lt, lte)**

  * ìˆ«ì ë˜ëŠ” ë‚ ì§œ í•„ë“œì— ëŒ€í•´ í¬ê¸°/ì‘ìŒì„ ë¹„êµ
  * ì˜ˆì‹œ:

    * `age__gt=20` â†’ ë‚˜ì´ê°€ 20ë³´ë‹¤ í° ë°ì´í„°
    * `created_at__lte='2024-01-01'` â†’ íŠ¹ì • ë‚ ì§œ ì´ì „/ê°™ì€ ë°ì´í„°

